groups:
  - name: host_slo_alerts
    interval: 30s
    rules:
      # ===== High CPU Usage (Saturation) =====
      - alert: HighCPUUsage
        expr: |
          100 - (avg(rate(node_cpu_seconds_total{mode="idle"}[5m])) * 100) > 80
        for: 5m
        labels:
          severity: warning
          service: host-system
          signal: saturation
        annotations:
          summary: "High CPU usage detected"
          description: |
            Alert Name: HighCPUUsage
            Expression (SLI): CPU usage is {{ $value | humanize }}% (threshold: 80%)
            Duration: Alert fires after condition persists for 5 minutes
            Details: System CPU utilization is critically high, which may impact application performance.

      # ===== High Memory Usage (Saturation) =====
      - alert: HighMemoryUsage
        expr: |
          (1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)) * 100 > 85
        for: 5m
        labels:
          severity: warning
          service: host-system
          signal: saturation
        annotations:
          summary: "High memory usage detected"
          description: |
            Alert Name: HighMemoryUsage
            Expression (SLI): Memory usage is {{ $value | humanize }}% (threshold: 85%)
            Duration: Alert fires after condition persists for 5 minutes
            Details: System memory utilization is critically high, which may lead to OOM conditions.

      # ===== Disk Space Warning =====
      - alert: DiskSpaceLow
        expr: |
          (1 - (node_filesystem_avail_bytes{mountpoint="/"} / node_filesystem_size_bytes{mountpoint="/"})) * 100 > 80
        for: 5m
        labels:
          severity: warning
          service: host-system
          signal: saturation
        annotations:
          summary: "Disk space running low"
          description: |
            Alert Name: DiskSpaceLow
            Expression (SLI): Disk usage is {{ $value | humanize }}% (threshold: 80%)
            Duration: Alert fires after condition persists for 5 minutes
            Details: Available disk space is critically low, which may cause service failures if logs or data cannot be written.
