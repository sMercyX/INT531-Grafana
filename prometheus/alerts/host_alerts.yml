groups:
  - name: host_slo_alerts
    interval: 30s
    rules:

      # =========================================================
      # Availability
      # =========================================================
      - alert: HostDown
        expr: up{job="node"} == 0
        for: 1m
        labels:
          severity: critical
          service: host-system
          signal: availability
        annotations:
          summary: "Host is unreachable"
          description: |
            Node exporter is not responding (up == 0).
            All services on this host may be impacted.
          runbook_url: https://github.com/sMercyX/INT531-Grafana/blob/main/runbooks/host-golden-signals.md


      # =========================================================
      # Saturation
      # =========================================================
      - alert: HighCPUUsage
        expr: |
          100 - (avg(rate(node_cpu_seconds_total{mode="idle"}[5m])) * 100) > 80
        for: 5m
        labels:
          severity: warning
          service: host-system
          signal: saturation
        annotations:
          summary: "High CPU usage detected"
          description: |
            CPU usage exceeded 80% for 5 minutes.
            This may degrade application performance on this host.
          runbook_url: https://github.com/sMercyX/INT531-Grafana/blob/main/runbooks/host-golden-signals.md


      - alert: HighMemoryUsage
        expr: |
          (1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)) * 100 > 85
        for: 5m
        labels:
          severity: warning
          service: host-system
          signal: saturation
        annotations:
          summary: "High memory usage detected"
          description: |
            Memory usage exceeded 85% for 5 minutes.
            Risk of OOM kills and service instability.
          runbook_url: https://github.com/sMercyX/INT531-Grafana/blob/main/runbooks/host-golden-signals.md


      - alert: DiskSpaceLow
        expr: |
          (1 - (node_filesystem_avail_bytes{mountpoint="/"} / node_filesystem_size_bytes{mountpoint="/"})) * 100 > 80
        for: 5m
        labels:
          severity: warning
          service: host-system
          signal: saturation
        annotations:
          summary: "Disk space running low"
          description: |
            Root filesystem disk usage exceeded 80% for 5 minutes.
            Services may fail if logs/data cannot be written.
          runbook_url: https://github.com/sMercyX/INT531-Grafana/blob/main/runbooks/host-golden-signals.md
